<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLAMEA Training - The Unbroken Chain</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@700&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/style.min.css">
    <style>
        body { font-family: 'Open Sans', sans-serif; }
        .main-container { display: flex; min-height: 100vh; }
        .main-content { flex-grow: 1; overflow-y: auto; background-size: cover; background-position: center center; }
        .module-card { border: 2px solid transparent; transition: all 0.3s ease; }
        .module-card:hover { transform: translateY(-5px); border-color: #f59e0b; }
        .module-card.selected { border-color: #f59e0b; background-color: rgba(245, 158, 11, 0.1); }
        .prose h2 { color: #fcd34d; } .prose h3 { color: #fde68a; } .prose strong { color: #fde68a; }
        .quiz-section, #end-screen { background-color: rgba(30, 41, 59, 0.8); backdrop-filter: blur(8px); }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">
    <div class="main-container">
        <div id="sidebar-placeholder"></div>
        <main class="main-content p-4 md:p-8 flex items-center justify-center">
            
            <div id="course-hub" class="max-w-4xl mx-auto text-center">
                <header class="mb-12">
                    <div class="flex justify-center items-center gap-4 mb-4">
                        <!-- SVG Icon for Unbroken Chain -->
                        <svg class="h-20 w-20 text-yellow-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" stroke-width="2">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.72"></path>
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.72"></path>
                        </svg>
                        <h1 class="text-4xl md:text-5xl font-bold font-roboto-slab text-white">The Unbroken Chain</h1>
                    </div>
                    <p class="text-lg text-gray-300">Inspired by "Beyond the Grave," this course explores the profound isiXhosa concept of legacy, duty, and the difference between a Successor and an Heir.</p>
                </header>

                <section id="module-selection-section">
                    <h2 class="text-2xl font-bold text-center text-orange-400 mb-6">Explore the Modules</h2>
                    <div id="module-selection" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="module-card bg-slate-800/80 p-6 rounded-xl cursor-pointer" data-module="1">
                            <h3 class="text-xl font-bold text-white mb-2">Defining the Roles</h3>
                            <p class="text-gray-400 text-sm">Learn the critical difference between a Western 'Heir' and an isiXhosa 'Successor' (Indlalifa).</p>
                        </div>
                        <div class="module-card bg-slate-800/80 p-6 rounded-xl cursor-pointer" data-module="2">
                            <h3 class="text-xl font-bold text-white mb-2">The Successor's Duties</h3>
                            <p class="text-gray-400 text-sm">Understand the responsibilities of carrying the family name and managing its legacy.</p>
                        </div>
                        <div class="module-card bg-slate-800/80 p-6 rounded-xl cursor-pointer" data-module="3">
                            <h3 class="text-xl font-bold text-white mb-2">Legacy in the Modern World</h3>
                            <p class="text-gray-400 text-sm">How to apply these traditional duties with wisdom in today's society.</p>
                        </div>
                    </div>
                </section>
            </div>
            
            <!-- Course Content & Quiz Area (Initially Hidden) -->
            <div id="content-area" class="w-full max-w-4xl mx-auto hidden">
                <div id="module-content" class="prose max-w-none prose-invert mb-8 bg-slate-800/70 p-6 rounded-lg"></div>
                <button id="start-quiz-btn" class="btn btn-primary w-full">Test Your Wisdom</button>
                <section id="quiz-section" class="quiz-section mt-8 p-8 rounded-lg hidden"></section>
                <div id="end-screen" class="end-screen mt-8 p-8 rounded-lg hidden text-center"></div>
                <button id="back-to-hub-btn" class="btn btn-secondary mt-4">Back to Modules</button>
            </div>

        </main>
    </div>

    <!-- Sidebar Loader Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const placeholder = document.getElementById('sidebar-placeholder');
            if(placeholder) {
                fetch('../training-sidebar.html')
                    .then(res => res.ok ? res.text() : Promise.reject('Sidebar not found'))
                    .then(data => placeholder.outerHTML = data)
                    .catch(err => console.error('Sidebar load error:', err));
            }
        });
    </script>
    
    <!-- Game Logic -->
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const courseHub = document.getElementById('course-hub');
        const contentArea = document.getElementById('content-area');
        const moduleContentEl = document.getElementById('module-content');
        const quizSection = document.getElementById('quiz-section');
        const startQuizBtn = document.getElementById('start-quiz-btn');
        const backToHubBtn = document.getElementById('back-to-hub-btn');
        const endScreen = document.getElementById('end-screen');
        const moduleCards = document.querySelectorAll('.module-card');

        const courseContent = {
            1: {
                title: 'Module 1: Defining the Roles - Successor (Indlalifa) vs. Heir',
                content: `
                    <p>In the modern world, influenced by Western law, the terms "successor" and "heir" are often used interchangeably. However, in traditional isiXhosa culture, their meanings are profoundly different. Understanding this distinction is key to grasping the deep sense of responsibility and legacy that defines the role of a firstborn son.</p>
                    <h3>The Western Concept: The Heir</h3>
                    <p>In Western legal systems, an <strong>heir</strong> is primarily someone who <strong>inherits assets</strong>â€”money, property, and possessions. Their role is largely passive; they receive what is left to them. While there may be an emotional connection to the deceased, the legal duty is transactional and focuses on the transfer of wealth.</p>
                    <h3>The isiXhosa Concept: The Successor (Indlalifa)</h3>
                    <p>In isiXhosa culture, the firstborn son is the <strong>Indlalifa</strong>, which means "the one who eats the inheritance," but its true meaning is far deeper. He is the <strong>successor</strong> to his father's role. He does not just inherit assets; he inherits <strong>responsibility</strong> for the entire family. He becomes the custodian of the family's name, its spiritual well-being, and its future. The assets he manages are not his to spend, but are for the benefit of the entire family, present and future.</p>
                `,
                questions: [
                    { q: "In Western law, what does an 'heir' primarily inherit?", a: "Assets like money and property", o: ["Responsibilities and duties", "A title with no assets"] },
                    { q: "What is the deeper meaning of 'Indlalifa' in isiXhosa culture?", a: "One who inherits responsibility for the family", o: ["The wealthiest member of the family", "The one who gets all the money"] }
                ]
            },
            2: {
                title: "Module 2: The Successor's Duties",
                content: `
                    <h3>A Duty of Stewardship</h3>
                    <p>The Indlalifa is a steward, not an owner in the Western sense. He must manage the family's resources wisely to ensure the well-being of his mother, his siblings, and future generations. This includes providing support, resolving disputes, and making decisions that benefit the collective, not just himself.</p>
                    <h3>A Spiritual Responsibility</h3>
                    <p>The successor is also the primary link to the ancestors. It is his duty to ensure that traditions are respected and that the family remains connected to its spiritual roots. This is not about power, but about service to the family, both living and deceased.</p>
                `,
                questions: [
                    { q: "What is the primary role of an Indlalifa regarding family assets?", a: "To manage them for the benefit of the whole family", o: ["To spend them as he wishes", "To sell them immediately"] },
                    { q: "The successor's spiritual duty involves connecting the family to what?", a: "The ancestors", o: ["The government", "Financial institutions"] }
                ]
            },
            3: {
                title: "Module 3: Legacy in the Modern World",
                content: `
                    <h3>Balancing Two Worlds</h3>
                    <p>As a modern South African father, you must navigate both Western law (e.g., creating a will) and your cultural duties. You can do both. Your will can reflect your role as a steward, ensuring assets are structured to support the family, not just be divided and consumed.</p>
                    <h3>The Power of Your Role</h3>
                    <p>Understanding your role as an Indlalifa is a source of immense strength. It provides a moral compass that guides you to be a leader, a provider, and a protector. It frames fatherhood not as a burden, but as a noble calling to continue an unbroken chain of legacy and responsibility.</p>
                `,
                questions: [
                    { q: "Can a modern father fulfill his role as Indlalifa while also following Western law?", a: "Yes, by structuring legal documents to reflect his duties.", o: ["No, the two systems are incompatible.", "Only if he gives away all assets."] },
                    { q: "Viewing yourself as a successor provides a...?", a: "Moral and spiritual compass", o: ["Reason to ignore modern law", "Way to claim all property for yourself"] }
                ]
            }
        };

        let currentModuleData = {};
        let currentQuestionIndex = 0;
        let score = 0;
        
        function displayModule(moduleNum) {
            currentModuleData = courseContent[moduleNum];
            courseHub.classList.add('hidden');
            contentArea.classList.remove('hidden');
            quizSection.classList.add('hidden');
            endScreen.classList.add('hidden');
            startQuizBtn.classList.remove('hidden');
            moduleContentEl.innerHTML = `<h2>${currentModuleData.title}</h2>${currentModuleData.content}`;
        }
        
        function setupQuiz() {
            startQuizBtn.classList.add('hidden');
            quizSection.classList.remove('hidden');
            currentQuestionIndex = 0;
            score = 0;
            loadQuestion();
        }

        function loadQuestion() {
            const questionData = currentModuleData.questions[currentQuestionIndex];
            let optionsHTML = shuffleArray([...questionData.o, questionData.a])
                .map(opt => `<div class="quiz-option p-3 rounded-lg border border-gray-600 hover:bg-slate-700 cursor-pointer" data-answer="${opt === questionData.a}">${opt}</div>`)
                .join('');
            quizSection.innerHTML = `<p class="font-semibold text-lg mb-4">${currentQuestionIndex + 1}. ${questionData.q}</p><div class="space-y-3">${optionsHTML}</div><div class="feedback mt-4 text-sm p-3 rounded-lg"></div>`;
        }

        function handleAnswerClick(e) {
            if (!e.target.classList.contains('quiz-option')) return;
            const selectedOption = e.target;
            const isCorrect = selectedOption.dataset.answer === 'true';
            const feedbackDiv = quizSection.querySelector('.feedback');
            
            quizSection.querySelectorAll('.quiz-option').forEach(opt => opt.style.pointerEvents = 'none');

            if (isCorrect) {
                selectedOption.classList.add('bg-green-500/50', 'border-green-500');
                feedbackDiv.innerHTML = '<p class="text-green-400 font-bold">Correct! You carry the wisdom of your lineage.</p>';
                score++;
            } else {
                selectedOption.classList.add('bg-red-500/50', 'border-red-500');
                feedbackDiv.innerHTML = '<p class="text-red-400 font-bold">Not quite. Reflect on the module content.</p>';
            }

            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < currentModuleData.questions.length) {
                    loadQuestion();
                } else {
                    showEndScreen();
                }
            }, 2000);
        }

        function showEndScreen() {
            quizSection.classList.add('hidden');
            endScreen.classList.remove('hidden');
            endScreen.innerHTML = `<h2 class="text-2xl font-bold font-roboto-slab text-green-400">Module Complete!</h2><p class="text-lg mt-2">You scored ${score} out of ${currentModuleData.questions.length}.</p><p class="mt-4">You have honored the unbroken chain.</p>`;
        }
        
        function goBackToHub() {
            contentArea.classList.add('hidden');
            courseHub.classList.remove('hidden');
            moduleCards.forEach(c => c.classList.remove('selected'));
        }

        function shuffleArray(array) { return [...array].sort(() => Math.random() - 0.5); }

        moduleCards.forEach(card => card.addEventListener('click', () => {
            selectCard(card, 'module');
            displayModule(parseInt(card.dataset.module));
        }));
        startQuizBtn.addEventListener('click', setupQuiz);
        quizSection.addEventListener('click', handleAnswerClick);
        backToHubBtn.addEventListener('click', goBackToHub);
        
        function selectCard(card, cardType) {
            document.querySelectorAll(`.${cardType}-card`).forEach(c => c.classList.remove('selected'));
            card.classList.add('selected');
        }
    });
    </script>
</body>
</html>
